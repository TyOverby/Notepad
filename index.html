<html>

<head>
    <title> Notepad - Ty Overby</title>
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>

    <style>
        body {
            margin: 0px;
            padding: 10px;
        }

        textarea {
            margin: 0px;
            padding: 0px;

            width: 100%;
            height: 100%;

            color: rgb(30, 30, 30);

            font-family: 'Ubuntu Mono', monospace;
            font-size: 18px;

            border: none;

            outline: 0px none transparent;
            resize: none;
        }
    </style>

</head>

<body>
    <textarea id="ta" spellcheck="false"> * write something here * </textarea>

    <script>
        // We use this a lot...
        var textarea = document.getElementById("ta");
        // Put the cursor in the textarea by default
        textarea.focus();

        function load() {
            window.onhashchange = load;

            // Check to see if we have localstorage capabilities
            if (window.localStorage) {
                var getTarget = function () {
                    return target = window.location.hash || "#default";
                };

                if (getTarget() === '#list') {
                    var items = Object.keys(localStorage);
                    items.sort();
                    textarea.value = items.join("\n");
                    return;
                } else {
                    // Load the text from storage if it exists
                    textarea.value = localStorage[getTarget()] || " Write something here.  It will wait for you if you come back. ";
                }

                // A function that saves the text to local storage
                var save = function () {
                    console.log(textarea.value, textarea.value.trim() === "");
                    if (textarea.value.trim() === "") {
                        console.log('deleting');
                        delete localStorage[getTarget()];
                    } else {
                        localStorage[getTarget()] = textarea.value;
                    }
                };

                // Every second, we save the textarea text
                // into localStorage.
                setInterval(save, 1000);

                // If we detect that the page is closing
                // save everything.
                window.onbeforeunload = save;
            }
            else {
                textarea.value = "For this to work, you need a browser with Local Storage.  Please come back with Chrome or Firefox.";
            }
        }
        load();
    </script>
</body>

</html>
